
# [Excel] 黙々と入力する際の設定

エクセルで入力作業をする際の設定です。
設定しなくても入力はできますが、ちょっと手を入れてあげれば楽になる場合もあります。
エクセルのバージョンや個々の設定によって機能しない場合もございますのでご了承ください。

### セルの編集
セルに文字を打ち込む際、「入力」と「編集」という二つのモードがあります。
セル選択の状態でキーボードを押して文字を入れると「入力」になります。
セル選択の状態でBackSpaceを押すと、セルの中身をクリアしてから「入力」になります。
一方、セル選択の状態で`F2`(ファンクション2)を押すと「編集」になります。
入力と編集の違いは、入力の場合は矢印キーを押すと「セルの移動」になります。
編集の場合は矢印キーを押すと「セル内でのカーソルの移動」になります。
(矢印キーだけでなく`Home`や`End`ボタンも同様です)
`F2`ボタンは押すごとに編集と入力を切り替えてくれるので、セルを移動と、セル内のカーソルの移動で使い分けることができます。

#### 注意点
IMEがオンの状態で、変換が確定していない場合は、矢印キーを押しても文字列内の移動となります。

### セルの移動
TABで右のセルに移動します。
Enterでは移動先を選ぶことができます。オプションで設定してください。
余談になりますが、私はセル値を確定したら数式バーで内容を確認したいので、Enterを押しても移動しない様にしています。

### 入力規則 (Alt, d, l)
入力規則もいろいろありますが、入力作業のときは列ごとに、IMEの「オン」または「オフ(英語モード)」を設定しておくと楽になります。
数字やアルファベットなど半角しか入力しない場合はオフにします。
日本語など全角を入力する場合はオンにします。
このIMEのオン・オフはセルを移動してきたときに作用します。「半角／全角キー」を押せば切替えられます。
入力規則のショートカットは`Alt, d, l`です。

### 表示／非表示
入力に必要のない列は非表示にしておきます。
これだけで作業がはかどることもあります。
列の非表示のショートカットは`Alt, o, c, h`です。

### 次の行への移動
VBAのイベント機能を使って次の行へ移動するようにすると、連続した入力が可能になります。

```VBA
' シートモジュールに設置してください。
' 17列目以降が選択された場合は次の行の先頭にカーソルを移動します。
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  If Target.Column >= 17 Then
    Cells(Target.Row + 1, 1).Select
  End If
End Sub
```

このマクロは対象のシートのモジュールに置いてください。
セルの選択が変更された際にこのイベントは発生します。
If〜End Ifの間にいろいろ追加することもできます。
`thisworkbook.save`を追加すれば保存をしてくれます。
Target.Rowで入力していた行番号を取得できるので、入力値の確認などもできます。

### 小技
#### 入力に特化させる
日本語の場合は漢字の変換に時間がかかります。
数値のみを扱った方が入力は早くなります。
はい・いいえなら、はいを1で入力し、いいえを2で入力します。
男性・女性なら男性を1に、女性を2と入力します。入力する際に脳で変換をしてしまうやり方です。
選択肢が並んでいる場合ならあまりミスなく入力できると思います。
(選択肢は５つくらいまでが無難です。それ以上になるとミスも増え、時間もかかると思います)
エクセルにはオートコンプリート機能(列方向のみですが、入力履歴をもとに入力候補を表示してくれる)がありますので
最初は「1 男性」や「2 女性」などと入力していけば1と入力すれば`1 男性`が候補に現れます。
また、入力規則でリストにしておくことも考えられます。`Alt + ↓`でリストが表示されます。




紙媒体のデータを電子データに変えるのは面倒です。
しかしやらなければならない状況も多々あります。
紙を使って簡単なアンケートをしたときや家計簿をつけるときなど、集計する前には「入力」が必要になります。
エクセルを使って入力しておけば、集計につなげるのも楽になります。
入力作業が「より楽になるように」するためのエクセルの設定です。

### エクセルの基本設定
エクセルは最上段と左端が埋まっていれば表と認識してくれます。
そのためにヘッダと左端は空セル(何も入っていないセル)がないようにします。
ヘッダは基本的に１行にしましょう。オートフィルタや並べ替えのときに不安要素がなくなります。
左端には連番(SEQ、ID、No.など)にします。







