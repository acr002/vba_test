
# memo

## variantへUsedrangeを代入する

```vba
a = ws.Usedrange.value
```

シートが使われていない場合、aはemptyのままです。
セルが1つだけ使われている場合は、その値が入ります。
2つ以上使われている場合は空列・空行を除いたセルが二次元配列として格納されます。
たとえ1列・1行しか使われていなくても配列になります。
行数と列数を取得するのにUBound()を使うので、エラーにならないよう
isempty()とisarray()で処理を分岐させます。

## 追加機能
ファイル数や対象のファイル名のリスト
これにさらにシート名を追加してもいいでしょう。

行数を把握し、余裕があるようなら各行の左端にファイル名やシート名を追記してもいいと思います。




