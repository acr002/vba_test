
Excel VBAからエクセルファイル(ブック)を開く方法です。

### オブジェクト
`workbookオブジェクト` がブックを表しています。
このオブジェクトを管理しているのが `workbooksオブジェクト` です。
単語の最後に`s`が付いただけです。workbookの複数形です。
管理しているといいましたが、いわゆるコンテナです。
開いているブック全てが格納されています。
これから開くブックに対してもこのオブジェクトから呼び出します。

### 特別なブック
上記のworkbooksオブジェクトを使わずにアクセスできるブックがあります。
まず、VBA(実行しているマクロ)が入っているブックで、 `Thisworkbook` で表します。
もう一つ、アクティブになっているブックを `Activeworkbook` で表すことができます。

`Thisworkbook.path`でパスが取得できます(基点となるのでよく使います)。
`Thisworkbook.name`でファイル名が取得できます(まぁ、使いませんけど)。
Activeworkbookはあまり使いません。明記していない場合はActiveworkbookが補完されることが理由の一つ、さらに、Excelでは新たに開いたブックが自動でActiveworkbookになってしまうことから、実行環境によって意図しない結果になる可能性があるからです。

### ブックを開く
このworkbookの管理者(workbooks)に`.Add`や`.open`メソッドを使ってブックを開きます。
これらのメソッドは`開いたブック`を返すので、`set + 変数 =`で受け取ります。

#### 新規ブック

```vba
dim wb as workbook
set wb = workbooks.add
```

#### 既存のファイル
既存のファイルを開くにはパスが必要です。

```vba
dim wb as workbook
set wb = workbooks.open(filename:=パス)
```

パスは相対パスでも絶対パスでも使うことができます。

#### 名前を付けて保存
`saveas`メソッドを使います。引数にパス(ファイル名)を指定します。

```vba
wb.saveas filename:=パス
```

#### 閉じる
`close`メソッドを使います。
個人的には`savechanges:=false`を付けることが多いです(ほぼ全て)。
この引数は「変更あるけど保存しなくていいの？」というエクセルからのメッセージを出さないようにするものです。
事前に保存していれば問題ありません。

```vba
wb.close savechanges:=false
```

### おわり
エクセルVBAはいろいろな方から悪者扱いされています。また煙たがられたりもします。
マクロ(VBA)が入っていると拡張子をxlsmにする必要があり、セキュリティによっては実行できなくなったり、メールでは受取拒否されたりします。
なので、ひっそりと使うために、データが入っているファイルと、マクロが入っているファイルを分けます。
別のファイルにするのは面倒ですが、以外と管理がしやすかったりするのでおすすめです。

さて、データ用ブックをマクロでいじるので、エクセルで開く必要があります。
(`ブック == エクセルのファイル`です。)
エクセルのVBAからブックを開く方法を下記に記述します。
まずはエクセルのブックオブジェクトから説明します。











